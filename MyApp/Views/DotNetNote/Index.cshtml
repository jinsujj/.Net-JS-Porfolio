@model IEnumerable<Note>

@inject INoteRepository DnnRepo

@{
    ViewData["Title"] = "Projects Blog";
}


<h2 style="text-align:center">Projects Blog</h2>
<span style="color: #ff0000">
    쌓여간 Projects 블로그 입니다.
</span>
<hr />
<div id="mySidenav" class="sidenav">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <a asp-action="Index">ALL</a>
    <hr />
    <a asp-action="Index" asp-route-category="Project">Projects</a>
    <a asp-action="Index" asp-route-category="Web">Web Framework</a>
    <a asp-action="Index" asp-route-category="DataBase">DataBase</a>
    <a asp-action="Index" asp-route-category="Anything">Anything</a>
    <a asp-action="Index" asp-route-category="Algorithm">Algorithm</a>
</div>
<span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; Index</span>
<br />
<div class="d-flex flex-row-reverse">
    <div class="d-flex flex-row-reverse">
        <span style="font-size:20px;" onclick="location.href='@Url.Action("Index", "DotNetNote")'"><i class="fas fa-list-ul"></i></span>&nbsp;&nbsp;
        <span style="font-size:20px;" onclick="location.href='@Url.Action("IndexCard", "DotNetNote")'"><i class="fas fa-th"></i></span>
    </div>
</div>
<table style="font-family: 'Open Sans', sans-serif; width: 100%;  margin-left: auto; margin-right: auto;">
    <tr>
        <td>
            <div style="text-align:right;font-size:8pt;">
                Total Record: @ViewBag.TotalRecord
            </div>
            <table class="table table-bordered table-hover table-striped table-sm">
                <tr style="background-color:rgb(222, 222, 222)">
                    <th style="width:50px; text-align:center;">
                        @Html.DisplayNameFor(model => model.Id)
                    </th>
                    <th style="width:360px; text-align:center;">
                        @Html.DisplayNameFor(model => model.Title)
                    </th>
                    @*<th style="width:60px; text-align:center">
                            @Html.DisplayNameFor(model => model.FileName)
                        </th>*@
                    <th style="width:80px; text-align:center;">
                        @Html.DisplayNameFor(model => model.Name)
                    </th>
                    <th style="width:100px; text-align:center;">
                        @Html.DisplayNameFor(model => model.PostDate)
                    </th>
                    <th style="width:80px; text-align:center;">
                        @Html.DisplayNameFor(model => model.ReadCount)
                    </th>
                </tr>

                @*<cache expires-after="@TimeSpan.FromMinutes(10)">*@
                @*최근 공지 글 2개 출력: 캐싱 적용*@
                @foreach (var item in
     DnnRepo.GetNoteSummaryByCategory("Notice").Take(2))
                {
                    <tr>
                        <td style="text-align:center;">
                            <span class="label label-success"
                                  style="font-size:xx-small">NOTICE</span>
                        </td>
                        <td>
                            @Html.Raw(BoardLibrary.FuncStep(item.Step))
                            <a asp-controller="DotNetNote"
                               asp-action="Details"
                               asp-route-id="@item.Id">
                                <strong>
                                    @StringLibrary.CutStringUnicode(
                                       item.Title, 30)
                                </strong>
                            </a>
                            <small>
                                @Html.Raw(BoardLibrary.ShowCommentCount(
                                    item.CommentCount))
                            </small>
                            @Html.Raw(BoardLibrary.FuncNew(item.PostDate))
                        </td>
                        @*<td style="text-align:center;">
                                @Html.Raw(BoardLibrary.FuncFileDownSingle(item.Id, item.FileName, item.FileSize.ToString(), "DotNetNote", "/BoardDown/"))
                            </td>*@
                        <td style="text-align:center;">
                            @Html.DisplayFor(modelItem => item.Name)
                        </td>
                        <td style="text-align:center;">
                            @BoardLibrary.FuncShowTime(item.PostDate)
                        </td>
                        <td style="text-align:right;">
                            @Html.DisplayFor(modelItem => item.ReadCount)
                        </td>
                    </tr>
                }
                @*</cache>*@

                @*게시글 출력*@
                @if (Model != null)
                {
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td style="text-align:center;">
                                @if (item.Step == 0)
                                {
                                    @Html.DisplayFor(modelItem => item.Id) }
                                else
                                {
                                    <text>&nbsp;</text>}
                            </td>
                            <td>
                                @Html.Raw(BoardLibrary.FuncStep(item.Step))
                                <a asp-controller="DotNetNote" asp-action="Details"
                                   asp-route-id="@item.Id">
                                    @StringLibrary.CutStringUnicode(item.Title, 30)
                                </a>
                                <small>
                                    @Html.Raw(BoardLibrary.ShowCommentCount(
                                        item.CommentCount))
                                </small>
                                @Html.Raw(BoardLibrary.FuncNew(item.PostDate))
                            </td>
                            @*<td style="text-align:center;">
                                    @Html.Raw(BoardLibrary.FuncFileDownSingle(item.Id, item.FileName, item.FileSize.ToString(), "DotNetNote", "/BoardDown/"))
                                </td>*@
                            <td style="text-align:center;">
                                @Html.DisplayFor(modelItem => item.Name)
                            </td>
                            <td style="text-align:center;">
                                @BoardLibrary.FuncShowTime(item.PostDate)
                            </td>
                            <td style="text-align:right;">
                                @Html.DisplayFor(modelItem => item.ReadCount)
                            </td>
                        </tr>
                    }}
            </table>
        </td>
    </tr>
    @*<tr style="display:flex; flex-wrap:wrap; justify-content:center">
            <td style="text-align:center;">
                <dnn-paging-helper url="@Context.Request.Path"
                                   page-index='Convert.ToInt32(Context.Request.Query["Page"])'
                                   page-size="10"
                                   record-count="@ViewBag.TotalRecord"
                                   search-mode='Convert.ToBoolean(@ViewBag.SearchMode)'
                                   search-field="@ViewBag.SearchField"
                                   search-query="@ViewBag.SearchQuery">
                </dnn-paging-helper>
            </td>
        </tr>*@
    <tr style="display:flex; flex-wrap:wrap; justify-content:center">
        <td class="text-center">
            @await Html.PartialAsync("_AdvancedPagingWithCss", ViewBag.PageModel as PagerBase)
        </td>
    </tr>
    <tr>
        @if (User.Identity.IsAuthenticated)
        {
            <td style="text-align:right;">
                <a asp-action="Create" class="btn btn-primary">글쓰기</a>
            </td>
        }
    </tr>
    <tr>
        <td style="text-align:center;">
            @await Html.PartialAsync("_SearchForm")
            <br />
            @if (ViewBag.SearchMode)
            {
                <a asp-controller="DotNetNote" asp-action="Index" class="btn btn-success">검색 완료</a>
            }
        </td>
    </tr>
</table>
<script>
    $(document).ready(function () {
        if (document.body.clientWidth >= 450) {
            document.getElementById("mySidenav").style.width = "250px";
        }
    })

    function openNav() {
        if (document.body.clientWidth < 450)
            document.getElementById("mySidenav").style.width = "100%";
        else
            document.getElementById("mySidenav").style.width = "250px";

        document.getElementById("main").style.marginLeft = "250px";
        document.body.style.backgroundColor = "rgba(0,0,0,0.4)";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
        document.getElementById("main").style.marginLeft = "0";
        document.body.style.backgroundColor = "white";
    }
</script>